# 第八章  安全模型、设计和功能的原则

本章涵盖的CISSP认证考试主题包括：
* 域3：安全架构和工程
	* 3.1 使用安全设计原则实施和管理工程过程
	* 3.2 理解安全模型的级别概念
	* 3.3 根据系统安全需求选择控制措施
	* 3.4 理解关于信息系统的安全能力
		
## 8.1 使用安全设计原则实施和管理工程过程
项目开发的早起阶段考虑安全性比再已有系统上添加安全性更容易。

### 8.1.1 客体和主体
* 主体(Subject)：发出访问资源请求的用户或进程。
* 访问意味着可读取一个资源或在其中写入数据。
* 客体(object)：用户或进程想要访问的资源。
* 信任传递：A信任B并且B信任C，则A通过信任传递信任C

### 8.1.2 封闭系统和开放系统
* 封闭式系统被设计用于较小范围内的其他系统协调工作，优点：更安全，缺点：缺乏容易集成的特点
* 开放式系统被设计为使用同一的行业标准

### 8.1.3 用于确保保密性、完整性和可用性的技术
* 限制：软件设计人员使用“进程限制”来约束程序的操作，进程限制使进程只能对某些内存位置和资源进行读取和写入，也被称为沙箱。限制可在操作系统本身实现(例如通过进程隔离和内存保护)，通过使用限制应用程序或服务(如Sandboxie)实现，或通过虚拟化虚拟机方案(VMware或Oracle的VirtualBox)实现。
* 界限：在系统上允许的每个进程都有授权级别，授权级别告知操作系统进程可执行什么操作，在简单系统中，只有两种授权级别：用户和内核。大多数系统中，界限划分出每个进程使用的内存逻辑区域，操作系统负责强制执行这些逻辑界限并禁止其他进程访问，更安全的系统可能需要物理上限制进程。物理界限要求每个限制进程的允许内存与其他受限进程的运行内存在物理上隔离。物理上限定内存可能非常昂贵，但它比逻辑边界更安全。
* 隔离：当通过执行访问界限来限制进程使，该进程将以隔离状态郧西，进程隔离能够确保隔离状态进程的任何行为仅影响与其关联的内存和资源。

### 8.1.4 控制
* 控制使用访问规则来限制主体对客体的访问
* 两种访问控制：
	* 强制访问控制(MAC)：在强制访问控制中，是否许可一个访问由主体和课题的静态属性来决定。每个主体拥有的属性用来定义其访问资源的许可或授权，每个课题拥有的属性用来定义其分类。
	* 自主访问控制(DAC)：主体具有一些定义访问客体的能力，自主访问控制允许主体根据需要定义要访问的客体列表，这些访问控制列表使主体可修改的动态访问规则集。
* 访问控制目的：通过阻止已授权或未经授权的主体的未授权访问，确保数据的保密性和完整性。

### 8.1.5 信任与保证
* 可信系统(trusted system)指所有保护机制协同工作的系统，为旭东类型的用户处理敏感数据，同时维护稳定和安全的计算环境。

## 8.2 理解安全模型的基本概念
* 集中描述客体必要的安全属性的方法：
	* 令牌：可传达关于客体的安全信息；
	* 能力列表：为每个受控客体维护一行安全属性信息。不如令牌灵活，但能在主体请求访问课题时提供更快的查找。
	* 安全标签：属性存储类型，附加客体的永久部分，安全标签设置后，通常无法更改。提供了防止篡改的保护措施。

### 8.2.1 可信计算基（Trusted Computing Base  TCB）
* 描述为硬件、软件和控件的组合，它们协同工作构成执行安全策略的可信根基。TCB是完整信息系统的子集。是系统中唯一可信任的部分。职责是确保系统在所有情况下都能正常运行，在所有情况下都遵守安全策略。

1. 安全边界
	* 假象的界限，将TCB于系统的其他部分隔开
	* 可信路径：TCB想要于系统其余部分进行通信，必须创建安全通道，称为可信路径。
2. 参考监视器和内核
	* TCB中负责在授权访问请求之前验证资源的部分称为参考监视器，位于每个主体和客体之间。
	* TCB中用于实现参考监视器功能的组件集合称为安全内核
	* 安全内核的目的是使用适当的组件以执行参考监视器的功能和抵抗所有已知的攻击,安全内核使用可信路径与主体进行通信。
	* 参考监视器需要有关其保护的每个资源的描述性信息，包括分类和名称，当主体请求访问客体时，参考监视器回查询客体的描述性信息，以确定应该允许还是拒绝访问。

### 8.2.2 状态机模型
* 状态机模型描述了一个无论处于何种状态下总是安全的系统，基于有限状态机(Finite State Machine, FSM)。FSM将外部输入与内部机器状态相结合，为何种复杂系统建模，包括解析器、解码器和解释器。给定一个输入和一个状态，FSM回转换到另一个状态并可能产出一个输出。下一个状态 = F(输入， 当前状态)。输出 = F(输入， 当前状态)。
* 安全状态机模型是许多安全模型的基础

### 8.2.3 信息流模型（BIBA、BLP）
* 信息流模型侧重于信息流，信息流模型基于状态机模型。Bell-LaPadula模型和Biba模型都是信息流模型。信息流模型不一定只处理信息流的方向，还可处理流动的类型。
* Bell-LaPadula模型关注的是防止信息从高安全级别向点低安全级别流动（上写下读）
* Biba关注的是防止信息从低级别向高安全级别流动（上读下写）
* 信息流模型旨在防止未授权的、不安全的或受限的信息流。
* 信息流模型可以用于建立同一对象不同时间点的两个版本或状态之间的关系。信息流模型还可以通过明确排除所有非定义流动路径来解决隐蔽通道问题。

### 8.2.4 非干扰模型
* 非干扰模型建立在信息流模型的基础上，关注较高安全级别的主体的动作如何影响系统状态或较低安全界别的主体的动作，更高的安全级别上发生的任何操作不会影响在较低级别上发生的操作。
* 属于信息流类别的组合理论：
	* 级联：一个系统的输入来自另一个系统的输出；
	* 反馈：一个系统向另一个系统提供输入，该系统通过颠倒这些角色进行互动。
	* 链接：一个系统将输入发送到另一个系统，但也将输入发送到外部实体。

### 8.2.5 Take-Grant模型
* 采用有向图来规定如何将权限从一个主体传递至另一个主体或者如何从一个主体传递至一个客体
* 除了“授予”，“获取”规则外，Take-Grant模型可采用创建规则和删除规则来生成或删除权限。
* 此模型的关键是使用这些规则可以让你了解系统中的权限何时可能更改以及可能发生泄漏(即无意的权限分配)的位置。

### 8.2.6 访问控制矩阵
* 访问控制矩阵：由主体和客体组成的表，表示每个主体可以对每个客体执行的动作或功能，矩阵的每列是访问控制列表，每行是一个能力列表。
* 实现访问控制矩阵模型设计以下内容：
	* 构建可以创建和管理主体和客体列表的环境；
	* 编写一个函数，他的输入可以是任何类型的对象，函数可以返回与此对象线管的类型。

### 8.2.7 Bell-LaPadula模型（解决机密性问题，下读上写）
* Bell-LaPadula模型解决保密性问题
* Bell-LaPadula多级模型原子国防部(DoD)的多级安全策略。多级安全策略规定，具有任何级别许可的主体可以访问其许可级别或以下级别的资源。但在较高许可级别内，仅在“致其所需”(need-to-know)的基础上授予访问权限。
* Bell-LaPadula模型防止分类信息泄露或传输至较低的安全许可级别，这是通过组织较低分类的主体访问较高级别的客体来实现的。
* Bell-LaPadula专注维护客体的保密性，但它没有解决客体的完整性或可用性方面的问题。
* Bell-LaPadula模型建立在状态机概念和信息流模型之上，采用强制访问控制和格子概念。各自层级是组织安全策略使用的分类级别。
* Bell-LaPadula 的三种属性：
	1. 简单安全属性：规定主体不能读取较高敏感度级别的信息(不准向上读)。
	2. *安全属性：规定主体不能将信息写入位于较低敏感度级别的客体(不准向下写)，也成为限制属性。
	3. 自由安全属性：规定系统使用访问控制矩阵执行自主访问控制。
	* 前两个属性定义了系统可以转换到的状态。所有通过这两个规则访问到的状态都是安全状态。
* Bell-LaPadula模型仅解决了数据的保密性问题，但没有设计数据的完整性或可用性。因此它经常与提供处理完整性和可用性机制的其他模型结合使用。

![](https://i.imgur.com/V3ikUom.jpg)

### 8.2.7 Biba模型（解决完整性问题，上读下写）
* Biba模型和Clark-Wilson模型解决完整性问题，建立在撞他及概念上，基于信息流，时一个多级别模型。
* Biba模型与Bell-LaPadula模型非常相似，除了方向相反之外，两者都使用状态和转换，都有基本属性。最大的不同在于主要关注点：Biba模型主要保护数据完整性。
* Biba模型状态机的基本属性或公理：
	1. 简单完整性属性：规定主体不能读取低级别的客体(不准向下读)
	2. *完整性属性：规定主体不能修改更高完整性级别的对象（不准向上写）
* 简单属性总是关于读，而*属性总是关于写。未被阻止或禁止的操作就是受支持或允许的。

![](https://i.imgur.com/uhsBpSq.jpg)

* Biba模型解决三个完整性问题：
	* 防止未授权的主体修改客体；
	* 防止已授权的主体对客体进行未授权的修改；
	* 保持内部和外部客体的一致性。
* Biba模型的缺陷：
	* 它仅解决了完整性问题，没有解决保密性性和可用性问题；
	* 重点是保护壳体免受外部威胁；它假定内部威胁以程序化方式处理；
	* 它没有设计访问控制管理，也没有提供方法来分配或更改壳体或主题的分类级别；
	* 它不能阻止隐蔽通道。
* Biba模型跟多用于商业安全模型。

### 8.2.9 Clark-Wilson模型（解决完整性问题）
* 它使用被称为三元组或访问控制三元组的主体/程序/客体(或主体/事务/客体)的三部分关系。
* 主体无法直接访问客体，客体只能通过程序进行访问，通过使用两个原则：标准格式的事务和职责分离。Clark-Wilson模型提供保护完整性的有效手段。
* 标准格式的事务采用程序的形式，主体只能通过使用程序、接口或访问门户来访问客体，每个程序对客体(例如数据库或其他资源)可以做什么和不能做什么都有特定限制。
* Clark-Wilson模型定义一下数据项和程序：
	* 受约束数据项(CDI)是完整性受到安全模型保护的任何数据项。
	* 无约束数据项(UDI)是不受安全模型控制的任何数据项，任何输入但未验证的数据或任何输出，将被视为无约束数据项。
	* 完整性验证过程(IVP)是扫描数据项并确认其完整性的过程。
	* 转换过程(TP)是唯一允许修改CDI的过程，通过TP限制对CDI的访问构成了Clark-Wilson完整性模型的支柱。
* Clark的优势：
	* 任何用户都不能未授权的修改数据
	* 实现职责分离

### 8.2.10 Brewer and Nash模型
* 根据用户行为动态改变访问控制方式、防止利益冲突。eg: A,B公司相互竞争，C又全访问A公司专有数据的人不应该被允许访问B公司类似数据。
* 该模型寄哪里了一类数据，定义了哪些安全域存在潜在的冲突，对于能够访问某个属于特定冲突类的安全与的任何主体，阻止他们访问属于相同冲突类的其他任何安全域。
* 研究Brewer and Nash模型的另一种方式是：管理员根据其分配的工作职责和工作任务，对系统中的大量数据具有完全的访问控制。

### 8.2.11 Goguen-Mesegure 模型（预设域或客体列表）
* Goguen-Mesegure模型是一个完整性模型，被认为是非干涉概念理论的基础。
* 基于预先确定集合或域(主体可访问的客体列表)。

### 8.2.12 Sutherland模型（解决完整性问题）
* 一个完整性模型，侧重于防止干扰以支持完整性。基于状态机模型和信息流模型。
* 该模型基于定义一组系统状态、初始状态以及状态转换的思想。通过仅使用这些预定的安全状态来保持完整性并且阻止干扰。

### 8.2.13 Graham-Denning模型
* 专注于主体和客体安全创建和删除。八个主要保护规则或操作的集合：
  * 安全地创建客体，主体，安全地删除客体、主体；安全地提供读取、授权、删除、传输访问权限。

## 8.3 基于系统安全需求选择控制和措施
* 一般需要采取措施来保证系统尽可能安全，在正式评估时，需要经过两个步骤：
  * 对系统进行测试和技术评估，以确保系统地安全功能负荷预期使用地标准；
  * 系统应对其设计和安全标准及其实际能力和性能进行正式比较，
  * 通常回聘请可信的第三方来执行类似评估。
* 三个主要评估模型或分类标准模型是:TCSEC,ITSEC, 通用准则(CC)。

### 8.3.1 彩虹系列
* 可信计算机系统评估标准（TCSEC），因为封面被称为彩虹系列

### 8.3.2 TCSEC（橙皮书）分类和所需功能
* TCSEC融合了功能性和保证，将系统提供的功能性和保密性保护等级分为四大类。定义了以下主要类别：
	* 类别A:已验证保护，最高的安全级别
	* 类别B:强制性保护
	* 类别C:自主性保护
	* 类别D:最小化保护。用于已被评估但达不到其他类别的要求的系统。
* 自主保护(类别C1, C2)提供了基本的访问控制。但缺乏更复杂和严格的控制。	
	* 自主保护(C1)通过用户ID/或组实现访问控制，只能提供较弱的保护。
	* 自主保护(C2)受控访问保护系统比C1系统更安全，用户只有金国单独识别后才能访问客体。C2还必须强制执行介质清理。强制执行严格的登录过程，已限制无效或未授权用户的访问。
* 强制保护(类别B1, B2, B3)具备细粒度的控制。此系统基于Bell-LaPadula模型，强制访问控制基于安全标签。
	* 标签化安全(B1)每个主体和客体都有一个安全标签。
	* 结构化安全(B2)除了对安全标签的要求外，必须确保不存在隐蔽通道。操作员和管理员职责分离，并且进程也要保持隔离。
	* 安全域(B3)通过进一步增加不想管进程的分离和隔离来提供更安全的功能，它明确地定义管理功能，并于其他用户使用地功能分开，B3系统重点转向简单性。以减少未使用或额外代码中罗东暴露地风险。
* 已验证保护(类A1)已验证保护系统与B3系统中采用地结构和控制类似，不同之处在于开发周期。开发周期每个阶段都是用正式方法进行控制。在进行下一步前，每个阶段地设计都需要记录、评估和验证。
* 彩虹系列的其他颜色
  * 红皮书：应用于为连接网络的独立计算机(TCSEC的可信网络解读)，比橘皮书更有价值，功能包括：
  	* 保密性和完整性的等级；
  	* 解决通信完整性问题；
  	* 解决拒绝服务保护问题；
  	* 解决危害(即入侵)防护和保护；
  	* 仅限于标记为“使用单一鉴别的集中式网络”的有限类别的网络。
  	* 仅使用四个评级：无(None)、C1(最小, Mininum)、C2(一般, Fair)、和B2(好, Good)。
  	* TCSEC的缺点：
  	1. 尽管TCSEC非常重视控制用户对信息的访问，却不控制授权用户如何处理信息。
  	2. 起源于国防部，TCSEC完全关注保密性，而不关注数据准确性或完整性。在商业环境中，数据准确性和完整性可能比保密性更重要。
  	3. 除评估标准自身强调访问控制外，TCSEC没有认真解决为完全试试安全策略必须采取的人员、物理和程序的政策问题，也未能提供保障措施，未处理影响系统安全的问题。
  	4. 橘皮书本上不涉及网络问题。
  * 绿皮书：绿皮书或“美国国防部密码管理指南”提供创建和管理的指南，对于哪些配置和管理可信系统的人来说，绿皮书很重要。

![](https://i.imgur.com/L7jpe4S.jpg)

* ITSEC类别所需保证和功能
 * ITSEC代表了欧洲在指定安全评估标准的初步尝试，它是作为TCSEC指南的替代方案而开发的。ITSEC指南评估系统的功能和保证。每个类别使用不同的评级。
 * ITSEC将评估中的系统称为评估目标(TOE),所有评估均为两类TOE评级标识，ITSEC使用两个尺度来评估功能和保证。
 * 系统的功能等级从F-D到F-B3进行评级(没有F-A1)，系统的保证等级从E0到E6进行评级。
 * ITSEC和TCSEC的差异：
  	* TCSEC只关注于保密性，而ITCSEC除了保密性外，还解决了缺少完整性和可用性的问题。
  	* ITCSEC不宜内与TCB的概念，也不要求在TCB中隔离系统的安全组件。
  	* TCSEC要求任何已更改的系统都要重新评估，无论是操作系统升级、打补丁还是修复以及应用程序升级或变更等，ITCSEC在发生此类变更后不需要进行新的正式评估。

### 8.3.3 通用准则
* 通用准则(CC)被设计为一个产品评估模型。
* 通用准则的认可：CC指南目标如下：
  * 增加购买者对已评估和已评级的IT产品安全性的信心。
  * 消除重复评估。
  * 是安全评估和认证过程更具有效益和效率。
  * 确保ITC产品的评估符合高标准和一致的标准。
  * 促进评估，并提高已评估和已评级的IT产品的可用性。
  * 评估IOE的功能性和保证。
* 通用准则基于两个要素：
  * 保护范畴和安全目标。保护范畴(Protection Profile, PP)为要评估的产品(TOE)指定安全要求和保护。这些要求被认为是客户的安全要求或“客户想要的安全”。PP回答“需要什么？”，而不涉及“如何实现？”
  * 安全目标(Security Targets, ST)指定了供应商的TOE内构建的安全申明。ST被认为是已实践的安全措施或供应商的“我将提供的安全”申明。ST回答“提供什么？”、“如何实现？”
* 通用准则的结构
  * CC指南分为三个部分：


### 8.3.4 ITSEC类别与所需的保证和功能性
* TCSEC几乎只关注机密性，ITSEC除了机密性外还关注完整性和可用性
* ITSEC并不依赖TCB的概念，不要求系统的安全组件在TCB内是隔离的
* TCSEC要求发生任何变化的系统都要重新评估

### 8.3.5 通用准则
通用准则(CC)全球性的标准，定义了测试和确定系统安全能力的各个级别

* 通用准则的认可，**保护轮廓和安全目标**：
	* 保护轮廓PP：指定被评估产品的安全需求和保护。满足特定的消费者需求的，独立于实现的一组安全要求。PP回答“需要什么？”，而不涉及“如何实现？”
	* 安全目标ST：指定通硬伤在TOE内构成的安全申明。依赖于实现的一组安全要求和说明，ST回答“提供什么？”、“如何实现？”
	* 评估目标TOE：IT产品或系统 + 相关的管理指南和用户指南文档。TOE是Common Criteria评估的对象
* 通用准则的结构
	* 部分1：介绍和一般模型描述用于评估IT安全性和指定评估目标设计的一般概念和基础模型
	* 部分2：安全功能描述
	* 部分3：安全保证
* 行业和国际安全实施指南
	* 常见安全标准： CC标准，PCI-DSS（支付行业数据安全标准），国际化标准组织（ISO）
	
### 8.3.6 认证和鉴定
* 认证
	* 对IT系统的技术和非技术安全特性以及其他防护措施的综合评估
	* 评估完所有的因素和确定系统的安全级别之后，认证阶段就完成了
* 鉴定
	* 领导层认可，测试和记录具有特定配置的系统的安全能力，认证和鉴定是一个不断重复的过程
* 认证和鉴定系统
	* 认证和鉴定过程的4个阶段：
		1. 定义：项目人员分配、项目需求的记录以及指导整个认证和鉴定过程的同安全许可协议的注册、协商和创建
		2. 验证：包括细化SSAA、系统开发活动以及认证分析
		3. 确定：细化SSAA，集成系统的认证评估、DAA建议的开发以及DAA的鉴定结果
		4. 后鉴定：维护SSAA、系统操作、变更管理以及遵从性验证

## 8.4 理解信息系统的安全功能

### 8.4.1 内存保护
* 内存保护是一个核心安全组件，必须对它进行设计和在操作系统中加以实现

### 8.4.2 虚拟化
* 虚拟化技术被用于在单一系统的内存中运行 一个或多个操作系统

### 8.4.3 可信平台模块
* 可信平台模块：及时对主板上加密处理芯片的描述，同时也是描述实施的通用名称
* HSM（硬件安全模块）：用于管理/存储数字加密秘钥、加速加密操作、支持更快的数字签名，以及提高身份认证的速度

### 8.4.4 接口
* 约束接口的目的是限制或制止授权和未经授权用户的行为，是Clark-Wilson安全模型的一种实践

### 8.4.5 容错
* 容错能力时指系统遭受故障，但持续运行的能力，容错是添加冗余组件